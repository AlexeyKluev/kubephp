#!/bin/sh
set -eu

# ----------------------------------------------------------------------------------------------------------------------

# Run Inside a subshell to not expose .env to entrypoint.
(
  # Load .env and .env.<APP_ENV> into script (won't overwrite OS env vars.)
  set -a
      env_overwrite=./.env.${APP_ENV-prod}
      env_local_overwrite=./.env.${APP_ENV-prod}.local
      export -p >> /tmp/envsrc && if [ -f "./.env" ]; then . ./.env; fi && if [ -f "${env_overwrite}" ]; then . $env_overwrite; fi && if [ -f "${env_local_overwrite}" ]; then . $env_local_overwrite; fi && . /tmp/envsrc \
      && rm /tmp/envsrc && unset env_overwrite && unset env_local_overwrite
  set +a

  # ----------------------------------------------------------------------------------------------------------------------

  # Add Prod Specific Entrypoints Here.

)


# Run Entrypoint and pass CMD to it (Don't forget exec)
exec base-entrypoint "${@}"